<!doctype html>
<html lang="en">
	<head>
		<title>poc theme selector</title>
	</head>
	<link rel="preconnect" href="https://rsms.me/" />
	<link rel="stylesheet" href="https://rsms.me/inter/inter.css" />
	<link rel="stylesheet" href="variables-standalone.css" id="theme-standalone" disabled />
	<link rel="stylesheet" href="variables-iframe.css" id="theme-iframe" disabled />
	<link rel="stylesheet" href="style.css" />
	<style>
		:root {
			font-family: Inter, sans-serif;
			font-feature-settings:
				"liga" 1,
				"calt" 1; /* fix for Chrome */
		}
		@supports (font-variation-settings: normal) {
			:root {
				font-family: InterVariable, sans-serif;
			}
		}
		main {
			width: 80ch;
			margin: auto;
		}
	</style>
	<body>
		<main>
			<h1>Example application</h1>
			<p>Lorem ipsum <span class="thingamajig">dolor</span> sit amet.</p>
			<div class="variant variant--standalone">
				<p>This application is now running in <span class="thingamajig">standalone</span> mode.</p>
				<p>
					In this variant the styling comes from the application itself (and has detected it is not
					running inside an iframe).
				</p>
				<p>Other variants:</p>
				<ul>
					<li><a href="iframe.html" target="_top">Iframed</a></li>
					<li><a href="injected.html" target="_top">Injected</a></li>
				</ul>
			</div>
			<div class="variant variant--iframed">
				<p>This application is now running in <span class="thingamajig">iframed</span> mode.</p>
				<p>
					In this variant the styling still comes from the application but it has selected a
					different theme as it detected to be running in an iframe.
				</p>
				<p>Other variants:</p>
				<ul>
					<li><a href="index.html" target="_top">Standalone</a></li>
					<li><a href="injected.html" target="_top">Injected</a></li>
				</ul>
			</div>
			<div class="variant variant--injected">
				<p>This application is now running in <span class="thingamajig">injected</span> mode.</p>
				<p>
					In this variant the styling comes from the parent window (i.e. it is injected by the
					parent into this application).
				</p>
				<p>Other variants:</p>
				<ul>
					<li><a href="index.html" target="_top">Standalone</a></li>
					<li><a href="iframe.html" target="_top">Iframe</a></li>
				</ul>
			</div>
		</main>
		<script type="module">
			const url = new URL(import.meta.url);
			const isInjected = url.searchParams.has("injected");
			const isIframe = window.self !== window.top;

			if (isInjected) {
				console.log("Application is running %cINJECTED%c!", "color: #0f0", "");
			} else if (isIframe) {
				console.log("Application is running %cIFRAMED%c!", "color: #f0a", "");
				document.getElementById("theme-iframe").disabled = false;
			} else {
				console.log("Application is running %cSTANDALONE%c!", "color: green", "");
				document.getElementById("theme-standalone").disabled = false;
			}
		</script>
	</body>
</html>
